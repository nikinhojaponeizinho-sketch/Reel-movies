<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Reel Evolution - Oficial</title>
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.5.1/dist/confetti.browser.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700&display=swap" rel="stylesheet">
    
    <style>
        :root { --primary: #e50914; --bg: #050505; --premium: #ffbb00; --text: #fff; --glass: rgba(255, 255, 255, 0.08); }
        body { margin: 0; font-family: 'Inter', sans-serif; background: var(--bg); color: var(--text); overflow-x: hidden; }
        
        .tela { display: none; min-height: 100vh; width: 100vw; flex-direction: column; align-items: center; animation: fadeIn 0.3s ease; }
        .tela.ativa { display: flex; }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }

        .glass { background: var(--glass); backdrop-filter: blur(15px); border: 1px solid rgba(255,255,255,0.1); border-radius: 20px; }

        /* BOT√ÉO "+" GRANDE PARA PERFIL */
        .btn-novo-perfil {
            width: 120px; height: 120px; 
            border: 3px dashed #444; border-radius: 25px; 
            display: flex; align-items: center; justify-content: center; 
            font-size: 60px; color: #444; cursor: pointer; transition: 0.3s;
        }
        .btn-novo-perfil:hover { border-color: var(--primary); color: var(--primary); background: rgba(229, 9, 20, 0.1); }

        .perfil-card { width: 120px; text-align: center; cursor: pointer; }
        .perfil-img { width: 120px; height: 120px; background: #1a1a1a; border-radius: 25px; border: 3px solid #333; display: flex; align-items: center; justify-content: center; font-size: 50px; color: var(--primary); transition: 0.3s; }
        .perfil-card:hover .perfil-img { border-color: var(--primary); transform: translateY(-5px); }

        /* BARRA DE PESQUISA */
        .search-container { width: 90%; max-width: 600px; margin: 20px 0; }
        .search-bar { width: 100%; padding: 15px 25px; border-radius: 50px; border: 1px solid rgba(255,255,255,0.1); background: var(--glass); color: white; font-size: 16px; outline: none; }
        .search-bar:focus { border-color: var(--primary); }

        /* PLAYER ESTILO CINEMA */
        #t-player { background: #000; position: fixed; inset: 0; z-index: 9999; justify-content: center; }
        .btn-voltar-player { position: absolute; top: 20px; left: 20px; background: rgba(40,40,40,0.9); color: white; border: 1px solid #555; padding: 12px 25px; border-radius: 50px; cursor: pointer; font-weight: bold; z-index: 100; }
        .video-wrapper { width: 95%; max-width: 1100px; aspect-ratio: 16/9; background: #000; border-radius: 12px; overflow: hidden; border: 1px solid #222; }
        iframe { width: 100%; height: 100%; border: none; }

        /* CAT√ÅLOGO */
        .header-home { width: 90%; max-width: 1200px; padding: 15px; display: flex; justify-content: space-between; align-items: center; }
        .cat-row { width: 90%; max-width: 1200px; margin-bottom: 30px; text-align: left; }
        .row-items { display: flex; gap: 15px; overflow-x: auto; padding: 10px 0; scrollbar-width: none; }
        .filme-card { min-width: 170px; height: 250px; background: #1a1a1a; border-radius: 15px; overflow: hidden; transition: 0.3s; cursor: pointer; flex-shrink: 0; border: 1px solid #222; }
        .filme-card img { width: 100%; height: 100%; object-fit: cover; }
        .filme-card:hover { transform: scale(1.05); border-color: var(--primary); }

        .btn-main { background: var(--primary); color: white; padding: 15px; border: none; border-radius: 12px; width: 100%; font-weight: bold; cursor: pointer; font-size: 16px; }
        input, select, textarea { width: 100%; padding: 14px; margin: 10px 0; border-radius: 10px; background: rgba(255,255,255,0.05); border: 1px solid #333; color: #fff; box-sizing: border-box; }
    </style>
</head>
<body>

    <div id="t-perfis" class="tela ativa">
        <h1 style="margin-top:60px; font-size: 35px;">REEL<span style="color:var(--primary)">EVOLUTION</span></h1>
        <p style="color: #888;">Selecione seu perfil para assistir</p>
        <div id="lista-p" style="display:flex; gap:25px; margin-top:40px; flex-wrap: wrap; justify-content: center; width: 90%;"></div>
        
        <div style="margin-top: 50px; display: flex; flex-direction: column; gap: 15px; align-items: center;">
            <button class="glass" onclick="ir('t-sync')" style="padding: 12px 40px; color:white; cursor:pointer; font-weight: bold;">üîÑ SINCRONIZAR APP</button>
            <button onclick="ir('t-adm-login')" style="background:none; border:none; color:#1a1a1a; font-size:12px; cursor:pointer;">PAINEL ADM</button>
        </div>
    </div>

    <div id="t-home" class="tela">
        <div class="header-home glass" style="margin-top: 15px;">
            <div><b id="user-n" style="font-size: 18px;">Ol√°</b><br><small id="status-txt" style="letter-spacing: 1px;"></small></div>
            <button onclick="ir('t-plano')" style="background:var(--premium); border:none; padding:10px 20px; border-radius:50px; font-weight:bold; cursor:pointer; color: black;">üíé PREMIUM</button>
        </div>

        <div class="search-container">
            <input type="text" id="busca" class="search-bar" placeholder="Pesquisar filmes, s√©ries..." oninput="filtrarFilmes()">
        </div>

        <div id="container-rows" style="width:100%; display:flex; flex-direction:column; align-items:center; padding-bottom: 50px;"></div>
    </div>

    <div id="t-player" class="tela">
        <button class="btn-voltar-player" onclick="fecharPlayer()">‚Üê VOLTAR AO CAT√ÅLOGO</button>
        <div class="video-wrapper" id="video-content"></div>
    </div>

    <div id="t-adm-login" class="tela">
        <div class="glass" style="padding:40px; width:320px; margin-top: 100px;">
            <h2 style="margin-top: 0;">Acesso Restrito</h2>
            <input type="password" id="pass-adm" placeholder="Senha Administrativa">
            <button onclick="loginAdm()" class="btn-main">ENTRAR NO PAINEL</button>
            <button onclick="ir('t-perfis')" style="background:none; border:none; color:#666; margin-top: 15px; cursor:pointer;">Voltar</button>
        </div>
    </div>

    <div id="t-adm-painel" class="tela">
        <div class="glass" style="padding:30px; width:90%; max-width:450px; margin: 30px 0;">
            <h3 style="color: var(--primary);">Gerenciar Cat√°logo</h3>
            <input type="text" id="f-tit" placeholder="T√≠tulo do Filme">
            <input type="text" id="f-url" placeholder="ID ou Link do Google Drive">
            <input type="text" id="f-capa" placeholder="Link da Imagem da Capa">
            <select id="f-cat">
                <option value="Lan√ßamentos">Lan√ßamentos</option>
                <option value="A√ß√£o">A√ß√£o</option>
                <option value="Terror">Terror</option>
                <option value="Com√©dia">Com√©dia</option>
            </select>
            <button onclick="addF()" class="btn-main" style="background: #28a745;">SALVAR FILME</button>
            
            <hr style="border: 0; border-top: 1px solid #333; margin: 25px 0;">
            
            <p style="font-size: 13px; color: #888;">Use o c√≥digo abaixo para enviar seus filmes para outro celular:</p>
            <button onclick="copiarSync()" class="btn-main" style="background:#007bff;">COPIAR C√ìDIGO DE SINCRONIZA√á√ÉO</button>
            
            <button onclick="ir('t-perfis')" style="margin-top:20px; background:none; color:white; border:none; cursor:pointer; width: 100%;">SAIR DO PAINEL</button>
        </div>
    </div>

    <div id="t-sync" class="tela">
        <div class="glass" style="padding:30px; width:320px; margin-top: 100px;">
            <h2>Sincronizar</h2>
            <p style="font-size: 14px; color: #888;">Cole o c√≥digo curto recebido para atualizar seu cat√°logo.</p>
            <textarea id="input-sync" style="height:120px;" placeholder="Cole aqui..."></textarea>
            <button onclick="importar()" class="btn-main">ATUALIZAR TUDO</button>
            <button onclick="ir('t-perfis')" style="background:none; border:none; color:#666; margin-top: 15px; cursor:pointer;">Cancelar</button>
        </div>
    </div>

    <div id="t-plano" class="tela">
        <div class="glass" style="padding:40px; width:320px; margin-top: 100px; text-align: center;">
            <h2 style="color:var(--premium)">Ativar Premium</h2>
            <p style="font-size: 14px; color: #aaa;">Insira sua chave de acesso para liberar todos os conte√∫dos.</p>
            <input type="text" id="chave-input" placeholder="REEL-XXXX">
            <button onclick="ativarChave()" class="btn-main">ATIVAR AGORA</button>
            <button onclick="ir('t-home')" style="margin-top:20px; background:none; border:none; color:#666; cursor:pointer;">Voltar</button>
        </div>
    </div>

    <script>
        // Vers√£o do Banco de Dados para evitar conflitos
        let db = JSON.parse(localStorage.getItem('reel_v20')) || [];
        let user = null;

        function ir(id) {
            document.querySelectorAll('.tela').forEach(t => t.classList.remove('ativa'));
            document.getElementById(id).classList.add('ativa');
            if(id === 't-perfis') renderPerfis();
            if(id === 't-home') renderHome();
            window.scrollTo(0,0);
        }

        function renderPerfis() {
            const cont = document.getElementById('lista-p');
            cont.innerHTML = '';
            
            // Renderiza perfis salvos
            Object.keys(localStorage).forEach(k => {
                if(k.startsWith('perfil_v20_')) {
                    let p = JSON.parse(localStorage.getItem(k));
                    let d = document.createElement('div');
                    d.className = 'perfil-card';
                    d.innerHTML = `<div class="perfil-img">${p.nome[0].toUpperCase()}</div><p style="font-weight:bold; margin-top:10px;">${p.nome}</p>`;
                    d.onclick = () => { user = p; ir('t-home'); };
                    cont.appendChild(d);
                }
            });

            // O "+" GRANDE SEMPRE NO FINAL
            let btnNovo = document.createElement('div');
            btnNovo.className = 'btn-novo-perfil';
            btnNovo.innerHTML = '+';
            btnNovo.onclick = () => { 
                let n = prompt("Nome do novo perfil:"); 
                if(n){ 
                    let id = 'perfil_v20_' + Date.now();
                    localStorage.setItem(id, JSON.stringify({id: id, nome: n, expira: 0})); 
                    renderPerfis(); 
                } 
            };
            cont.appendChild(btnNovo);
        }

        function renderHome(filtro = "") {
            document.getElementById('user-n').innerText = "Ol√°, " + user.nome;
            const exp = user.expira > Date.now();
            document.getElementById('status-txt').innerText = exp ? "PLATINUM ATIVO" : "CONTA LIMITADA";
            document.getElementById('status-txt').style.color = exp ? "gold" : "#e50914";

            const cont = document.getElementById('container-rows');
            cont.innerHTML = '';

            const filmesFiltrados = db.filter(f => f.tit.toLowerCase().includes(filtro.toLowerCase()));
            const categorias = [...new Set(filmesFiltrados.map(f => f.cat))];

            if(filmesFiltrados.length === 0) {
                cont.innerHTML = '<p style="margin-top:50px; color:#555;">Nenhum filme encontrado...</p>';
                return;
            }

            categorias.forEach(cat => {
                let section = document.createElement('div');
                section.className = 'cat-row';
                section.innerHTML = `<h3 style="margin-left: 5px;">${cat}</h3><div class="row-items"></div>`;
                
                filmesFiltrados.filter(f => f.cat === cat).forEach(f => {
                    let card = document.createElement('div');
                    card.className = 'filme-card';
                    card.innerHTML = `<img src="${f.capa}">`;
                    card.onclick = () => { 
                        if(exp) abrirPlayer(f); 
                        else ir('t-plano'); 
                    };
                    section.querySelector('.row-items').appendChild(card);
                });
                cont.appendChild(section);
            });
        }

        function filtrarFilmes() {
            renderHome(document.getElementById('busca').value);
        }

        function abrirPlayer(f) {
            ir('t-player');
            const videoId = f.url.match(/[-\w]{25,}/);
            const linkFinal = videoId ? `https://drive.google.com/file/d/${videoId[0]}/preview` : f.url;
            
            document.getElementById('video-content').innerHTML = `
                <iframe src="${linkFinal}" 
                allow="autoplay; fullscreen" 
                sandbox="allow-forms allow-scripts allow-pointer-lock allow-same-origin allow-top-navigation" 
                allowfullscreen></iframe>`;
        }

        function fecharPlayer() { 
            document.getElementById('video-content').innerHTML = ''; 
            ir('t-home'); 
        }

        function loginAdm() {
            const senha = document.getElementById('pass-adm').value;
            if(['Nicolas','Yudi','Opanioto'].includes(senha)) {
                ir('t-adm-painel');
            } else {
                alert("Senha incorreta!");
            }
        }

        function addF() {
            const t = document.getElementById('f-tit').value;
            const u = document.getElementById('f-url').value;
            const c = document.getElementById('f-capa').value;
            const cat = document.getElementById('f-cat').value;

            if(t && u && c) {
                db.push({tit: t, url: u, capa: c, cat: cat});
                localStorage.setItem('reel_v20', JSON.stringify(db));
                alert("Filme adicionado com sucesso!");
                document.getElementById('f-tit').value = '';
                document.getElementById('f-url').value = '';
                document.getElementById('f-capa').value = '';
            } else {
                alert("Preencha todos os campos!");
            }
        }

        // SINCRONIZA√á√ÉO ULTRA CURTA (Base64)
        function copiarSync() {
            if(db.length === 0) return alert("Adicione filmes antes de copiar!");
            const codigoCurto = btoa(unescape(encodeURIComponent(JSON.stringify(db))));
            navigator.clipboard.writeText(codigoCurto);
            alert("C√≥digo CURTO copiado para o WhatsApp!");
        }

        function importar() {
            try {
                const cod = document.getElementById('input-sync').value;
                const dados = JSON.parse(decodeURIComponent(escape(atob(cod))));
                db = dados;
                localStorage.setItem('reel_v20', JSON.stringify(db));
                alert("Cat√°logo atualizado com sucesso!");
                ir('t-perfis');
            } catch(e) {
                alert("C√≥digo inv√°lido ou corrompido!");
            }
        }

        function ativarChave() {
            const chave = document.getElementById('chave-input').value;
            if(chave.toUpperCase().includes("REEL")) {
                user.expira = Date.now() + (30 * 24 * 60 * 60 * 1000); // 30 dias
                localStorage.setItem(user.id, JSON.stringify(user));
                confetti({ particleCount: 150, spread: 70, origin: { y: 0.6 } });
                alert("PREMIUM ATIVADO COM SUCESSO!");
                ir('t-home');
            } else {
                alert("Chave inv√°lida!");
            }
        }

        // Inicia o App
        renderPerfis();
    </script>
</body>
</html>
