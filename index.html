<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Reel Movies Evolution - Master</title>
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.5.1/dist/confetti.browser.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700&display=swap" rel="stylesheet">
    
    <style>
        :root { --primary: #e50914; --bg: #050505; --card: #121212; --premium: #ffbb00; --text: #fff; --glass: rgba(255, 255, 255, 0.05); }
        body { margin: 0; font-family: 'Inter', sans-serif; background: var(--bg); color: var(--text); overflow-x: hidden; scroll-behavior: smooth; }
        
        /* Sistema de Telas */
        .tela { display: none; min-height: 100vh; width: 100vw; box-sizing: border-box; flex-direction: column; align-items: center; animation: fadeIn 0.4s ease; }
        .tela.ativa { display: flex; }
        @keyframes fadeIn { from { opacity: 0; transform: scale(0.98); } to { opacity: 1; transform: scale(1); } }

        /* Estilo Vidro (Glassmorphism) */
        .glass { background: var(--glass); backdrop-filter: blur(15px); border: 1px solid rgba(255,255,255,0.1); border-radius: 20px; }

        /* TELA: PLAYER (ESTILO SUA IMAGEM) */
        #t-player { background: #000; padding: 0; justify-content: center; position: fixed; inset: 0; z-index: 9999; }
        .player-top-bar { position: absolute; top: 20px; left: 20px; right: 20px; display: flex; align-items: center; z-index: 100; }
        .btn-voltar-player { background: rgba(30, 30, 30, 0.9); color: white; border: 1px solid #444; padding: 12px 25px; border-radius: 50px; cursor: pointer; display: flex; align-items: center; gap: 10px; font-weight: bold; transition: 0.3s; }
        .btn-voltar-player:hover { background: var(--primary); transform: scale(1.05); }
        .video-wrapper { width: 95%; max-width: 1100px; aspect-ratio: 16/9; background: #0a0a0a; border-radius: 12px; overflow: hidden; box-shadow: 0 0 50px rgba(0,0,0,1); border: 1px solid #222; }
        iframe { width: 100%; height: 100%; border: none; }

        /* TELA: HOME E CAT√ÅLOGO */
        .header-home { width: 90%; max-width: 1200px; padding: 15px 25px; display: flex; justify-content: space-between; align-items: center; margin-top: 20px; }
        .banner { width: 90%; max-width: 1150px; height: 400px; border-radius: 30px; background-size: cover; background-position: center; position: relative; display: flex; align-items: flex-end; padding: 40px; box-sizing: border-box; margin: 20px 0; border: 1px solid rgba(255,255,255,0.1); }
        .banner-overlay { position: absolute; inset: 0; background: linear-gradient(0deg, #050505 5%, transparent 100%); border-radius: 28px; }

        /* Grid de Filmes */
        .cat-row { width: 90%; max-width: 1200px; text-align: left; margin-bottom: 30px; }
        .row-items { display: flex; gap: 15px; overflow-x: auto; padding: 10px 0; scrollbar-width: none; }
        .row-items::-webkit-scrollbar { display: none; }
        .filme-card { min-width: 170px; height: 250px; background: #1a1a1a; border-radius: 15px; overflow: hidden; transition: 0.3s; cursor: pointer; border: 1px solid #222; flex-shrink: 0; }
        .filme-card:hover { transform: scale(1.1); border-color: var(--primary); z-index: 10; }
        .filme-card img { width: 100%; height: 100%; object-fit: cover; }

        /* UI Geral */
        .box-geral { padding: 30px; width: 100%; max-width: 400px; text-align: center; }
        input, select, textarea { width: 100%; padding: 14px; margin: 10px 0; border-radius: 10px; background: rgba(255,255,255,0.05); border: 1px solid #333; color: #fff; box-sizing: border-box; }
        .btn-main { background: var(--primary); color: white; padding: 15px; border: none; border-radius: 10px; width: 100%; font-weight: bold; cursor: pointer; }
        
        #toast { position: fixed; bottom: 20px; right: 20px; background: #222; color: #fff; padding: 15px 25px; border-radius: 10px; display: none; z-index: 10000; border-left: 5px solid var(--primary); }
    </style>
</head>
<body>

    <audio id="snd-pop" src="https://assets.mixkit.co/active_storage/sfx/2571/2571-preview.mp3"></audio>
    <audio id="snd-click" src="https://assets.mixkit.co/active_storage/sfx/2568/2568-preview.mp3"></audio>
    <audio id="snd-win" src="https://assets.mixkit.co/active_storage/sfx/2013/2013-preview.mp3"></audio>

    <div id="toast">Notifica√ß√£o</div>

    <div id="t-perfis" class="tela ativa">
        <h1 style="font-size: 40px; margin-top: 50px;">REEL<span style="color:var(--primary)">EVOLUTION</span></h1>
        <p style="color: #666;">Quem est√° assistindo agora?</p>
        <div id="lista-p" style="display:flex; gap:20px; margin-top:40px; flex-wrap: wrap; justify-content: center;"></div>
        <div style="margin-top: 50px; display: flex; flex-direction: column; gap: 10px;">
            <button class="glass" onclick="ir('t-sync')" style="padding: 12px 30px; color:white; cursor:pointer;">üîÑ SINCRONIZAR APP</button>
            <button onclick="ir('t-adm-login')" style="background:none; border:none; color:#222; font-size:10px; cursor:pointer;">ADM</button>
        </div>
    </div>

    <div id="t-home" class="tela">
        <div class="header-home glass">
            <div style="text-align: left;">
                <h3 id="user-n" style="margin:0; font-size: 16px;">Ol√°</h3>
                <small id="status-txt" style="font-weight: bold;"></small>
            </div>
            <div style="display:flex; gap:10px;">
                <button onclick="ir('t-plano')" style="background:var(--premium); color:black; border:none; padding:8px 15px; border-radius:20px; font-weight:bold; cursor:pointer; font-size:11px;">üíé MEU PLANO</button>
                <button class="glass" onclick="ir('t-perfis')" style="color:white; padding:8px 15px; cursor:pointer; font-size:11px;">SAIR</button>
            </div>
        </div>

        <div id="banner-main" class="banner">
            <div class="banner-overlay"></div>
            <div style="position:relative; z-index:2; text-align:left;">
                <h2 id="b-titulo" style="font-size: 35px; margin:0;">Destaque</h2>
                <button id="b-play" class="btn-main" style="width:auto; margin-top:20px; padding: 12px 40px;">‚ñ∂ ASSISTIR</button>
            </div>
        </div>

        <div id="container-rows" style="width:100%; display:flex; flex-direction:column; align-items:center;"></div>
    </div>

    <div id="t-player" class="tela">
        <div class="player-top-bar">
            <button class="btn-voltar-player" onclick="fecharPlayer()">
                <svg width="20" height="20" fill="white" viewBox="0 0 24 24"><path d="M15.41 16.59L10.83 12l4.58-4.59L14 6l-6 6 6 6 1.41-1.41z"/></svg>
                VOLTAR AO CAT√ÅLOGO
            </button>
            <span id="p-titulo" style="margin-left:20px; font-size: 18px; text-shadow: 2px 2px 5px #000;">T√≠tulo do Filme</span>
        </div>
        
        <div class="video-wrapper" id="video-content">
            </div>
    </div>

    <div id="t-plano" class="tela">
        <div class="box-geral glass">
            <h2 style="color:var(--premium)">Assinatura</h2>
            <p style="color:#888; font-size:14px;">Ative seu acesso para liberar todos os filmes.</p>
            <button onclick="window.open('https://wa.me/5543999843889')" style="background:#25d366; color:white;" class="btn-main">WHATSAPP SUPORTE</button>
            <input type="text" id="chave-input" placeholder="Cole sua chave REEL-XXXX">
            <button onclick="ativarChave()" class="btn-main">ATIVAR AGORA</button>
            <button onclick="ir('t-home')" style="background:none; color:#555; margin-top:15px; cursor:pointer; border:none;">Voltar</button>
        </div>
    </div>

    <div id="t-adm-login" class="tela">
        <div class="box-geral glass">
            <h2>Painel ADM</h2>
            <input type="password" id="pass-adm" placeholder="Sua Senha">
            <button onclick="loginAdm()" class="btn-main">ENTRAR</button>
            <button onclick="ir('t-perfis')" style="background:none; color:#555; margin-top:10px; border:none; cursor:pointer;">Voltar</button>
        </div>
    </div>

    <div id="t-adm-painel" class="tela">
        <div class="box-geral glass" style="max-width: 500px;">
            <h3>Gerenciar Filmes</h3>
            <p>Chave: <b id="c-exibir" style="color:gold">---</b> <button onclick="gerarC()" style="font-size:10px;">Gerar</button></p>
            <input type="text" id="f-tit" placeholder="T√≠tulo">
            <input type="text" id="f-url" placeholder="Link V√≠deo Drive">
            <input type="text" id="f-capa" placeholder="Link Capa">
            <select id="f-cat">
                <option value="Lan√ßamentos">Lan√ßamentos</option>
                <option value="A√ß√£o">A√ß√£o</option>
                <option value="Terror">Terror</option>
            </select>
            <button onclick="addF()" class="btn-main" style="background:#28a745;">SALVAR FILME</button>
            <button onclick="copiarSync()" class="btn-main" style="background:#007bff; margin-top:10px;">COPIAR C√ìDIGO SYNC</button>
            <button onclick="ir('t-perfis')" class="btn-main" style="background:#333; margin-top:20px;">SAIR</button>
        </div>
    </div>

    <div id="t-sync" class="tela">
        <div class="box-geral glass">
            <h2>Sincronizar</h2>
            <textarea id="input-sync" style="height:100px;" placeholder="Cole o c√≥digo..."></textarea>
            <button onclick="importar()" class="btn-main">ATUALIZAR TUDO</button>
            <button onclick="ir('t-perfis')" style="background:none; color:#555; margin-top:10px; border:none; cursor:pointer;">Voltar</button>
        </div>
    </div>

    <script>
        let db = JSON.parse(localStorage.getItem('reel_v14')) || [];
        let user = null;

        function ir(id) {
            document.querySelectorAll('.tela').forEach(t => t.classList.remove('ativa'));
            document.getElementById(id).classList.add('ativa');
            if(id === 't-perfis') renderPerfis();
            if(id === 't-home') renderHome();
            window.scrollTo(0,0);
        }

        function playSnd(id) { const s = document.getElementById(id); s.currentTime = 0; s.play(); }

        function notify(m) {
            const t = document.getElementById('toast');
            t.innerText = m; t.style.display = 'block';
            setTimeout(() => t.style.display = 'none', 3000);
        }

        function format(u, t) {
            const id = u.match(/[-\w]{25,}/);
            if(id && u.includes('drive')) {
                return t === 'v' ? `https://drive.google.com/file/d/${id[0]}/preview` : `https://drive.google.com/uc?export=view&id=${id[0]}`;
            }
            return u;
        }

        function renderPerfis() {
            const cont = document.getElementById('lista-p');
            cont.innerHTML = '';
            Object.keys(localStorage).forEach(k => {
                if(k.startsWith('px14_')) {
                    let p = JSON.parse(localStorage.getItem(k));
                    let d = document.createElement('div');
                    d.innerHTML = `<div style="width:100px; height:100px; background:#1a1a1a; border-radius:20px; border:2px solid #333; display:flex; align-items:center; justify-content:center; font-size:40px; cursor:pointer; color:var(--primary);">${p.nome[0]}</div><p>${p.nome}</p>`;
                    d.onclick = () => { playSnd('snd-pop'); user = p; ir('t-home'); };
                    cont.appendChild(d);
                }
            });
            let m = document.createElement('div');
            m.innerHTML = `<div style="width:100px; height:100px; border:2px dashed #444; border-radius:20px; display:flex; align-items:center; justify-content:center; font-size:40px; color:#444; cursor:pointer;">+</div><p>Novo</p>`;
            m.onclick = () => { let n = prompt("Nome:"); if(n){ localStorage.setItem('px14_'+Date.now(), JSON.stringify({id:'px14_'+Date.now(), nome:n, expira:0})); renderPerfis(); } };
            cont.appendChild(m);
        }

        function renderHome() {
            document.getElementById('user-n').innerText = "Ol√°, " + user.nome;
            const exp = user.expira > Date.now();
            document.getElementById('status-txt').innerText = exp ? "PLATINUM" : "CONTA GR√ÅTIS";
            document.getElementById('status-txt').style.color = exp ? "gold" : "red";

            if(db.length > 0) {
                const l = db[db.length - 1];
                document.getElementById('banner-main').style.backgroundImage = `url(${format(l.capa, 'i')})`;
                document.getElementById('b-titulo').innerText = l.tit;
                document.getElementById('b-play').onclick = () => { if(exp) abrirPlayer(l); else ir('t-plano'); };
            }

            const cont = document.getElementById('container-rows');
            cont.innerHTML = '';
            const cats = [...new Set(db.map(f => f.cat))];
            cats.forEach(c => {
                let s = document.createElement('div');
                s.className = 'cat-row';
                s.innerHTML = `<h3>${c}</h3><div class="row-items" id="row-${c.replace(/\s/g,'')}"></div>`;
                cont.appendChild(s);
                db.filter(f => f.cat === c).forEach(f => {
                    let cd = document.createElement('div');
                    cd.className = 'filme-card';
                    cd.innerHTML = `<img src="${format(f.capa, 'i')}">`;
                    cd.onclick = () => { if(exp) abrirPlayer(f); else ir('t-plano'); };
                    document.getElementById(`row-${c.replace(/\s/g,'')}`).appendChild(cd);
                });
            });
        }

        function abrirPlayer(f) {
            playSnd('snd-click');
            ir('t-player');
            document.getElementById('p-titulo').innerText = f.tit;
            const area = document.getElementById('video-content');
            // Corre√ß√£o Final do Player com Sandbox para n√£o dar erro
            area.innerHTML = `
                <iframe src="${format(f.url, 'v')}" 
                allow="autoplay; fullscreen" 
                sandbox="allow-forms allow-scripts allow-pointer-lock allow-same-origin allow-top-navigation"
                allowfullscreen></iframe>`;
        }

        function fecharPlayer() {
            document.getElementById('video-content').innerHTML = '';
            ir('t-home');
        }

        // ADM E LOGICA
        function loginAdm() {
            if(['Nicolas','Yudi','Opanioto'].includes(document.getElementById('pass-adm').value)) {
                ir('t-adm-painel');
                document.getElementById('c-exibir').innerText = localStorage.getItem('chave_master') || "---";
            } else { notify("Senha incorreta!"); }
        }

        function gerarC() {
            let c = "REEL-" + Math.floor(1000 + Math.random() * 9000);
            localStorage.setItem('chave_master', c);
            document.getElementById('c-exibir').innerText = c;
        }

        function addF() {
            let t = document.getElementById('f-tit').value, u = document.getElementById('f-url').value, c = document.getElementById('f-capa').value, ct = document.getElementById('f-cat').value;
            if(!t || !u) return notify("Preencha tudo!");
            db.push({tit:t, url:u, capa:c, cat:ct});
            localStorage.setItem('reel_v14', JSON.stringify(db));
            notify("Filme Salvo!");
            ir('t-home');
        }

        function copiarSync() {
            let s = btoa(unescape(encodeURIComponent(JSON.stringify({f:db, c:localStorage.getItem('chave_master')}))));
            navigator.clipboard.writeText(s); notify("C√≥digo Copiado!");
        }

        function importar() {
            try {
                let d = JSON.parse(decodeURIComponent(escape(atob(document.getElementById('input-sync').value))));
                db = d.f; localStorage.setItem('reel_v14', JSON.stringify(db));
                localStorage.setItem('chave_master', d.c);
                playSnd('snd-win'); notify("Sincronizado!"); ir('t-perfis');
            } catch(e) { notify("C√≥digo inv√°lido!"); }
        }

        function ativarChave() {
            if(document.getElementById('chave-input').value === localStorage.getItem('chave_master')) {
                user.expira = Date.now() + (30 * 24 * 60 * 60 * 1000);
                localStorage.setItem(user.id, JSON.stringify(user));
                playSnd('snd-win');
                confetti({ particleCount: 150, spread: 70, origin: { y: 0.6 } });
                notify("PREMIUM ATIVADO!");
                setTimeout(() => ir('t-home'), 2000);
            } else { notify("Chave inv√°lida!"); }
        }

        renderPerfis();
    </script>
</body>
</html>